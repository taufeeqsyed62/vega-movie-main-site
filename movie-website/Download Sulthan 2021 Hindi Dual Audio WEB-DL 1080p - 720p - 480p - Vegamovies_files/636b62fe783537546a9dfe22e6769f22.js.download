function checkUrlChange(){window.previousHref!==window.location.href&&(window.handledInsIdsOnPage=[],window.previousHref=window.location.href)}if(window.handledInsIdsOnPage=window.handledInsIdsOnPage||[],window.previousHref=window.previousHref||window.location.href,window.addEventListener("popstate",checkUrlChange),window.addEventListener("hashchange",checkUrlChange),void 0===startAdAngle)var adAngleClientId="604c7625",adAngleHostUrl="cvt-s2.adangle.online",startAdAngle=function(){checkUrlChange();const e=[],t=document.getElementsByClassName(adAngleClientId);let n=!1;t&&Object.keys(t).map((n=>{const{key:o}=t[n].dataset;if(handledInsIdsOnPage.includes(o))return;handledInsIdsOnPage.push(o);const a={};Object.keys(t[n].attributes).map((e=>{const o=t[n].attributes[e];if(new RegExp(/-cp-/).test(o.name)){const e=o.name.replace("data-cp-",""),t=encodeURIComponent(o.value);a[`${e}`]=t}})),e.push({cp:a,key:o})}));const o=`https://${adAngleHostUrl}/b/json`,a=(e,t,n)=>{"use strict";var o=new XMLHttpRequest;""===e&&(e="/"),o.open("POST",e,!0),o.setRequestHeader("Content-type","application/json; charset=utf-8"),o.onload=function(e){n(e.currentTarget.response)},o.send(JSON.stringify(t))},d=e=>(new Image).src=e,c=(e,t,n)=>{if("function"==typeof String.prototype.replaceAll)return e.replaceAll(t,n);{const o=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(o,"g");return e.replace(a,n)}},r=({banner_id:e,body:t,trackers:n,transaction_id:o})=>{const a=document.querySelectorAll(`[data-key="${e}"]`);a.length&&Object.keys(a).map((r=>{const i=new Image;3!==t._template&&(i.src=t._impression);const s=i.src;let l=t._body;l=c(l,"$$BANNER_URL$$",s),l=c(l,"$$UUID$$",e),l=c(l,"$$TRANSACTION_ID$$",o),l=c(l,"$$CLICK_URL$$",t._click),l=c(l,"$$TRACKERS_JSON$$",JSON.stringify(n));const{ins_div:m,ins_container:u}=(({body:e,banner_id:t})=>{const n=document.createElement("ins");n.id=`ins-${t}`,n.style="text-decoration: none; margin: 0px auto; padding: 0px; display: block; background: transparent; position: relative;";const o=document.createElement("style");o.type="text/css",o.id=`adangle-${t}-styles`,o.innerHTML=`#adangle-${t}-div,\n\t\t\t\t\t\t    \t#adangle-${t}-div *{margin:0;padding:0;font-size:14px;line-height:normal;font-family:serif;cursor:pointer}\n\t\t\t\t\t\t\t\t`;const a=document.createElement("div");return a.id=`adangle-${t}-div`,a.innerHTML=e,n.appendChild(o),n.appendChild(a),{ins_div:a,ins_container:n,ins_styles:o}})({body:l,banner_id:e}),p=document.createElement("div");let h=null;try{h=(new DOMParser).parseFromString(l,"text/html");h.querySelectorAll("script").forEach((e=>{const t=document.createElement("script");Array.from(e.attributes).forEach((e=>{t.setAttribute(e.name,e.value)})),e.src||(t.textContent=e.textContent),p.appendChild(t)}))}catch(e){console.log(e)}if(a[r].innerHTML="",a[r].appendChild(u),a[r].appendChild(p),h.querySelector("iframe")){const e=u.querySelector("iframe");e.addEventListener("load",(()=>{e.contentWindow.postMessage({landingPage:t._click},"*")}))}else if(h.querySelector("img")){const o=m.querySelector(`#adangle-${e}-click`);if(null!==o){if("function"!=typeof v)var v=e=>{e.stopPropagation(),n.px&&n.px.map((e=>{2===e.event&&d(e.code)})),window.open(t._click)};"ontouchend"in document.documentElement?o.addEventListener("touchend",v,!1):o.addEventListener("click",v,!1)}}else if(h.querySelector("a")||h.querySelector("section")){if(void 0===v)v=()=>{n.px&&n.px.map((e=>{2===e.event&&d(e.code)})),window.open(t._click),(h.querySelector(`.adangle-${e}-pop`)||3!==t._template)&&document.querySelector(`[data-key="${e}"]`).remove(),setTimeout((()=>{window.removeEventListener?"ontouchend"in document.documentElement?document.removeEventListener("touchend",v,!1):document.removeEventListener("click",v,!1):window.detachEvent&&document.body.detachEvent("onclick",v)}),500)};3===t._template?window.addEventListener?"ontouchend"in document.documentElement?document.addEventListener("touchend",v,!1):document.addEventListener("click",v,!1):window.attachEvent&&document.body.attachEvent("onClick",v):m.querySelector(`#adangle-${e}-click`).addEventListener("click",v)}2!==t._method&&null===m.querySelector(`#adangle-${e}-click`)&&3!==t._template&&(n.px.length&&n.px.map((e=>{1===e.event&&d(e.code)})),n.js.length&&n.js.map((e=>{u.insertAdjacentHTML("beforeend",e.code)}))),setTimeout((()=>{const t=document.getElementById(`adangle-${e}`);t&&t.classList.add(`animation-${e}`)}),100)}))},i=e=>{var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},s={},l=e=>{const t=document.querySelector(`[data-key="${e.banner_id}"]`),n=(o=t,a=t=>{t&&!s[e.banner_id]&&(s[e.banner_id]=!0,r(e))},function(){var e=i(o);e!=d&&(d=e,"function"==typeof a&&a(e))});var o,a,d;window.addEventListener?(addEventListener("DOMContentLoaded",n,!1),addEventListener("load",n,!1),addEventListener("scroll",n,!1),addEventListener("resize",n,!1)):window.attachEvent&&(attachEvent("onDOMContentLoaded",n),attachEvent("onload",n),attachEvent("onscroll",n),attachEvent("onresize",n)),n()},m={},u={},p=()=>{m[4]&&m[4].map((e=>{(e=>{const t=()=>{u[e.banner_id]||(console.log(1),u[e.banner_id]=!0,r(e))};document.addEventListener("scroll",t),document.addEventListener("mousemove",t),document.addEventListener("touchstart",t)})(e)}))},h=e=>{!e.error&&e.banners&&(Object.keys(e.banners).map((t=>{const n="object"==typeof e.trackers&&e.trackers[t]?e.trackers[t]:[],o=e.banners[t]?e.banners[t]:[],a=e.transaction_id?e.transaction_id:0;"object"!=typeof m[e.banners[t]._method]&&(m[e.banners[t]._method]=[]),m[e.banners[t]._method].push({banner_id:t,body:o,trackers:n,transaction_id:a})})),m[1]&&m[1].map((e=>{r(e)})),m[2]&&m[2].map((e=>{r(e)})),m[3]&&m[3].map((e=>{l(e)})),p())},v=(t,n)=>{t.forEach((t=>{"childList"===t.type&&t.addedNodes.forEach((t=>{"604c7625"===t.className&&a(o,e,(e=>h(JSON.parse(e))))}))}))};(()=>{const t=()=>{n||(n=!0,a(o,e,(e=>{try{const t=JSON.parse(e);h(t)}catch(e){console.error("Ошибка при парсинге данных:",e)}})))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):"interactive"!==document.readyState&&"complete"!==document.readyState||t();new MutationObserver(v).observe(document.documentElement,{childList:!0,subtree:!0}),n||t()})()};void 0!==startAdAngle&&startAdAngle();